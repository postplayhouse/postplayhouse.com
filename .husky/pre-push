while read local_ref local_sha remote_ref remote_sha
do
# Only run svelte-check when pushing to origin/master
  if [ "$remote_ref" = "refs/heads/master" ]; then
    if ! (pnpm run check && pnpm run test:unit --run); then
      echo "Pre-push checks failed. Push aborted."
      exit 1
    fi
    break
  fi
done