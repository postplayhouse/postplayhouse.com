{"id":"postplayhouse.com-04o","title":"TypeError: Load failed (network fetch failure)","description":"**Sentry Issues:** JAVASCRIPT-SVELTEKIT-A2, JAVASCRIPT-SVELTEKIT-9V\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-A2\n**Occurrences:** Multiple\n\n**Error:** TypeError: Load failed (postplayhouse.com)\n**Affected pages:** /(app), /(app)/ticket-info\n**File:** src/routes/(app)/+page.ts, src/routes/(app)/ticket-info/+page.ts\n\n**Likely Cause:** Network fetch operations failing during page load. Could be due to:\n- User network interruption\n- API endpoint temporarily unavailable\n- Request timeout\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T22:54:18.211791-05:00","updated_at":"2025-12-21T23:01:27.951456-05:00","closed_at":"2025-12-21T23:01:27.951456-05:00","close_reason":"Network connectivity issue on user's end - not a code bug","labels":["bug"]}
{"id":"postplayhouse.com-0za","title":"Export and cleanup","description":"Create export endpoint for YAML generation. Document end-of-season archival workflow. Remove or deprecate old GitHub PR code.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-22T00:06:00.378184-05:00","updated_at":"2025-12-22T00:06:00.378184-05:00","dependencies":[{"issue_id":"postplayhouse.com-0za","depends_on_id":"postplayhouse.com-wb6","type":"parent-child","created_at":"2025-12-22T00:06:18.284577-05:00","created_by":"daemon"},{"issue_id":"postplayhouse.com-0za","depends_on_id":"postplayhouse.com-pb0","type":"blocks","created_at":"2025-12-22T00:06:24.244131-05:00","created_by":"daemon"}]}
{"id":"postplayhouse.com-2ef","title":"DevalueError: Cannot stringify arbitrary non-POJOs","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-A1\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-A1\n**Occurrences:** 1\n**First Seen:** 2025-12-09\n\n**Error:** DevalueError: Cannot stringify arbitrary non-POJOs\n**Culprit:** GET /(app) - during prerender of getMediaImages\n\n**Stacktrace:** Error in devalue stringify when trying to serialize data from /\\_app/remote/prqesa/getMediaImages endpoint.\n\n**Likely Cause:** The getMediaImages endpoint returns data that contains non-serializable objects (like class instances, functions, or complex objects). Data passed to SvelteKit must be plain JSON-serializable objects.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T22:54:15.042385-05:00","updated_at":"2025-12-21T23:00:50.275184-05:00","closed_at":"2025-12-21T23:00:50.275184-05:00","close_reason":"Fixed by refactoring media page to use enhanced:img (commits after Dec 9)","labels":["bug"]}
{"id":"postplayhouse.com-395","title":"TypeError: Cannot read properties of undefined (reading 'sources')","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-A0\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-A0\n**Occurrences:** Multiple\n**First Seen:** 2025-12-09\n\n**Error:** TypeError: Cannot read properties of undefined (reading 'sources')\n**Culprit:** GET /(app)/media\n\n**Likely Cause:** The media page loader is accessing .sources property on an undefined object. Check the data loading logic for the media page.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T22:54:14.478813-05:00","updated_at":"2025-12-21T23:00:50.726196-05:00","closed_at":"2025-12-21T23:00:50.726196-05:00","close_reason":"Fixed by refactoring media page - no longer accesses .sources directly (commits after Dec 9)","labels":["bug"]}
{"id":"postplayhouse.com-3it","title":"CustomEvent: unhandled promise rejection","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-7Q\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-7Q\n**Occurrences:** Multiple\n**First Seen:** 2024\n\n**Error:** Event CustomEvent (type=unhandledrejection) captured as promise rejection\n**Affected pages:** /(app)/productions/[year], /(app)/jobs\n\n**Likely Cause:** An async operation is failing and the promise rejection is not being caught. Check for missing try/catch blocks or .catch() handlers on promises in the productions and jobs pages.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T22:54:16.950017-05:00","updated_at":"2025-12-21T23:01:55.397521-05:00","closed_at":"2025-12-21T23:01:55.397521-05:00","close_reason":"No stacktrace available - likely browser extension or third-party script. 15 occurrences over 11 months, not reproducible.","labels":["bug"]}
{"id":"postplayhouse.com-502","title":"TypeError: Failed to fetch dynamically imported module","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-S\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-S\n**Occurrences:** Multiple\n**First Seen:** 2024 (ongoing)\n\n**Error:** TypeError: Failed to fetch dynamically imported module (various node files)\n**Affected pages:** /, /jobs, /ratings/, /productions/*, /calendar/*\n\n**Likely Cause:** Dynamic module fetching fails when:\n- Deployment changes chunk hashes but user has cached HTML\n- Network issues during lazy loading\n- Browser extensions blocking requests\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T22:54:13.923511-05:00","updated_at":"2025-12-21T23:01:28.875786-05:00","closed_at":"2025-12-21T23:01:28.875786-05:00","close_reason":"Dynamic import cache issue - same as JAVASCRIPT-SVELTEKIT-T, happens when cached JS becomes stale after deployments","labels":["bug"]}
{"id":"postplayhouse.com-5p9","title":"New submission flow","description":"Create /api/bio-submission/submit/+server.ts using Blobs. Upload original images to B2 originals/ folder. Update frontend form to use new endpoint.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T00:05:59.516398-05:00","updated_at":"2025-12-22T00:05:59.516398-05:00","dependencies":[{"issue_id":"postplayhouse.com-5p9","depends_on_id":"postplayhouse.com-wb6","type":"parent-child","created_at":"2025-12-22T00:06:17.737553-05:00","created_by":"daemon"},{"issue_id":"postplayhouse.com-5p9","depends_on_id":"postplayhouse.com-v1t","type":"blocks","created_at":"2025-12-22T00:06:23.692877-05:00","created_by":"daemon"}]}
{"id":"postplayhouse.com-6r0","title":"SSR data endpoint","description":"Create /api/people/[year].json/+server.ts that merges YAML data with approved bios from Blobs. Add cache headers with tags for CDN purging.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:05:58.651488-05:00","updated_at":"2025-12-22T23:22:01.229564-05:00","closed_at":"2025-12-22T23:22:01.229564-05:00","close_reason":"Created /api/people/[year].json SSR endpoint that merges YAML data with approved bios from Netlify Blobs for current season. Includes cache headers with tags for CDN purging.","dependencies":[{"issue_id":"postplayhouse.com-6r0","depends_on_id":"postplayhouse.com-wb6","type":"parent-child","created_at":"2025-12-22T00:06:17.180128-05:00","created_by":"daemon"},{"issue_id":"postplayhouse.com-6r0","depends_on_id":"postplayhouse.com-f0u","type":"blocks","created_at":"2025-12-22T00:06:23.089508-05:00","created_by":"daemon"}]}
{"id":"postplayhouse.com-8db","title":"SyntaxError: Unexpected token - not found is not valid JSON","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-A4\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-A4\n**Occurrences:** 1\n**First Seen:** 2025-12-15\n\n**Error:** SyntaxError: Unexpected token 'o', \"not found\" is not valid JSON\n**Culprit:** GET /(app)/plan-your-visit\n**File:** src/routes/(app)/plan-your-visit/+page.ts:5\n\n**Stacktrace shows:** The load function calls res.json() on a response that contains the text \"not found\" instead of valid JSON.\n\n**Likely Cause:** An API endpoint is returning a 404 or error response with plain text \"not found\" instead of JSON. The plan-your-visit page tries to parse this as JSON.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T22:54:16.306876-05:00","updated_at":"2025-12-21T22:58:07.423603-05:00","closed_at":"2025-12-21T22:58:07.423603-05:00","close_reason":"Fixed by commit 3a8b772c on Dec 15 - refactored to use static TypeScript data instead of API fetch","labels":["bug"]}
{"id":"postplayhouse.com-ags","title":"Try out beads","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T14:40:33.198421-05:00","updated_at":"2025-12-21T14:54:22.174857-05:00","closed_at":"2025-12-21T14:54:22.174857-05:00","close_reason":"Beads setup verified complete: daemon running, config set, JSONL tracked in git"}
{"id":"postplayhouse.com-cuf","title":"TypeError: Importing a module script failed","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-T\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-T\n**Occurrences:** 617\n**First Seen:** 2024-03-17\n**Last Seen:** 2025-12-19\n\n**Error:** TypeError: Importing a module script failed\n**Culprit:** /(app)\n**Affected browsers:** Mobile Safari, various\n\n**Likely Cause:** Module import failures typically occur when browser cache has stale references after deployment, network interruption during module loading, or dynamic imports failing due to version mismatches.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T22:54:12.786732-05:00","updated_at":"2025-12-21T23:01:12.332208-05:00","closed_at":"2025-12-21T23:01:12.332208-05:00","close_reason":"Browser caching issue, not a code bug - happens when cached JS modules become stale after deployments. Common with SPAs.","labels":["bug"]}
{"id":"postplayhouse.com-f0u","title":"Infrastructure setup","description":"Install @netlify/blobs and @netlify/functions. Add @netlify/vite-plugin to vite.config.ts. Create src/lib/server/blobs.ts with helpers. Add isAdmin(position) to passphraseHelpers.ts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:05:58.219707-05:00","updated_at":"2025-12-22T23:06:30.416069-05:00","closed_at":"2025-12-22T23:06:30.416069-05:00","close_reason":"Infrastructure setup complete: installed @netlify/blobs, @netlify/functions, and @netlify/vite-plugin; created blobs.ts helpers; added isAdmin() function","dependencies":[{"issue_id":"postplayhouse.com-f0u","depends_on_id":"postplayhouse.com-wb6","type":"parent-child","created_at":"2025-12-22T00:06:16.894377-05:00","created_by":"daemon"}]}
{"id":"postplayhouse.com-fjd","title":"Error: Unable to preload CSS","description":"**Sentry Issues:** JAVASCRIPT-SVELTEKIT-8B, 9P, 9W, 9X, 9Y, A5\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-8B\n**Occurrences:** 152+ across multiple issue variants\n**First Seen:** 2025-05-23\n\n**Error:** Error: Unable to preload CSS for https://postplayhouse.com/\\_app/immutable/assets/1.B8231T6f.css\n**Affected pages:** Various (/, /who/*, /calendar/*, /plan-your-visit/, etc.)\n**Affected browsers:** Chrome, various\n\n**Likely Cause:** CSS preload failures occur when:\n- Deployment changes file hashes but user has cached HTML\n- CDN/network issues preventing CSS delivery\n- Browser extensions blocking resource loading\n- CORS or mixed content issues\n\nThis is a common SvelteKit issue related to cache invalidation between deployments.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T22:54:17.537447-05:00","updated_at":"2025-12-21T23:01:28.415385-05:00","closed_at":"2025-12-21T23:01:28.415385-05:00","close_reason":"CSS cache invalidation between deployments - not a code bug, same root cause as module import failures","labels":["bug"]}
{"id":"postplayhouse.com-l4v","title":"ReferenceError: site is not defined","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-A3\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-A3\n**Occurrences:** 1+\n**First Seen:** 2025-12-15\n\n**Error:** ReferenceError: site is not defined\n**Culprit:** GET /(app)/data/productions/[year].json\n\n**Likely Cause:** A variable named 'site' is referenced but not defined in the productions data endpoint. Check the page.svelte.js or server files for missing imports or variable definitions.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T22:54:15.62778-05:00","updated_at":"2025-12-21T23:00:49.820805-05:00","closed_at":"2025-12-21T23:00:49.820805-05:00","close_reason":"One-time build error from Dec 15 - never recurred, code is correct","labels":["bug"]}
{"id":"postplayhouse.com-pb0","title":"Admin UI and image processing","description":"Create /admin/bios route with passphrase-based admin auth. List pending bios with preview. Approve button processes image with Sharp, uploads optimized to B2. Reject button deletes from Blobs and sends Basecamp message. Done Approving button purges CDN cache and warms cache.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T00:05:59.949427-05:00","updated_at":"2025-12-22T00:05:59.949427-05:00","dependencies":[{"issue_id":"postplayhouse.com-pb0","depends_on_id":"postplayhouse.com-wb6","type":"parent-child","created_at":"2025-12-22T00:06:18.009337-05:00","created_by":"daemon"},{"issue_id":"postplayhouse.com-pb0","depends_on_id":"postplayhouse.com-5p9","type":"blocks","created_at":"2025-12-22T00:06:23.968861-05:00","created_by":"daemon"}]}
{"id":"postplayhouse.com-uop","title":"Error: 500 during SvelteKit prerender","description":"**Sentry Issue:** JAVASCRIPT-SVELTEKIT-9Z\n**URL:** https://post-playhouse.sentry.io/issues/JAVASCRIPT-SVELTEKIT-9Z\n**Occurrences:** 8\n**First Seen:** 2025-12-09\n**Last Seen:** 2025-12-15\n\n**Error:** Error: 500 /plan-your-visit/ (linked from /plan-your-visit)\n**Culprit:** SvelteKit prerender.js\n\n**Stacktrace:** Error occurs in @sveltejs/kit prerender.js when saving prerendered pages - indicates a server-side error during static site generation.\n\n**Related Issues:** Likely related to JAVASCRIPT-SVELTEKIT-A4 (JSON parse error) which occurs on the same /plan-your-visit page.\n\n**Seer Analysis:** Not available (no budget)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T22:54:13.34742-05:00","updated_at":"2025-12-21T22:58:07.897329-05:00","closed_at":"2025-12-21T22:58:07.897329-05:00","close_reason":"Fixed by commit 3a8b772c on Dec 15 - prerender now succeeds (was caused by JSON parse error in plan-your-visit)","labels":["bug"]}
{"id":"postplayhouse.com-v1t","title":"Page SSR conversion","description":"Modify /who/[year]/+page.ts to route current season to SSR endpoint. Modify /program-bios/+page.ts to use SSR endpoint. Keep historical years prerendered.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:05:59.083016-05:00","updated_at":"2025-12-22T23:29:12.712262-05:00","closed_at":"2025-12-22T23:29:12.712262-05:00","close_reason":"Routed /who/[year] and /program-bios to use SSR endpoint for current season. Historical years remain prerendered.","dependencies":[{"issue_id":"postplayhouse.com-v1t","depends_on_id":"postplayhouse.com-wb6","type":"parent-child","created_at":"2025-12-22T00:06:17.461578-05:00","created_by":"daemon"},{"issue_id":"postplayhouse.com-v1t","depends_on_id":"postplayhouse.com-6r0","type":"blocks","created_at":"2025-12-22T00:06:23.412374-05:00","created_by":"daemon"}]}
{"id":"postplayhouse.com-wb6","title":"Bio Submission \u0026 Approval System","description":"Replace GitHub PR-based bio submission with Netlify Blobs storage, in-site admin approval UI, SSR for current season pages, and CDN cache purging for instant updates.\n\n## Architecture Overview\n\n```\nUser submits bio → Netlify Blobs (metadata) + B2 (original image)\n                         ↓\nAdmin approves via /admin/bios → Sharp processes image → stores optimized in B2\n                         ↓\nAdmin clicks \"Done Approving\" → CDN cache purged + cache warmed\n                         ↓\nEnd of season: Export approved bios to YAML → commit to Git\n```\n\n## Key Changes\n\n### 1. Pending Bio Storage\n- **Bio metadata**: Netlify Blobs (JSON) - `pending-bios` store\n  - `{season}/pending/{position}` - awaiting approval\n  - `{season}/approved/{position}` - approved, visible on site\n- **Images in B2**:\n  - `originals/{season}/{name}.jpg` - untouched upload (for archives)\n  - `optimized/{season}/{name}.jpg` - processed on approval (served to users)\n\n### 2. Image Processing (on approval)\nWhen admin approves a bio:\n1. Fetch original image from B2\n2. Use Sharp to resize/compress (800x800 max, quality 80, progressive JPEG)\n3. Upload optimized version to B2\n4. Bio references the optimized URL\n\n### 3. SSR for Current Season Pages\nConvert these pages from prerendered to SSR:\n- `/who/{currentYear}` - only current season, historical years stay prerendered\n- `/program-bios` - always shows current season\n\nCache headers:\n```\nCache-Control: public, max-age=0\nNetlify-CDN-Cache-Control: public, max-age=86400, stale-while-revalidate=3600\nCache-Tag: people-2026,bios\n```\n\n### 4. Admin UI \u0026 Auth\nNew route `/admin/bios`:\n- **Auth**: Reuse existing passphrases - flag certain positions as admins (e.g., positions 1-4)\n- Passphrase identifies who approved each bio\n- Lists pending bios with preview\n- Approve button (no reject storage - just Basecamp message)\n- **Batch workflow**: Approve multiple, then click \"Done Approving\" to purge CDN cache once and warm cache\n\n### 5. Rejection Flow\nNo rejection storage. When admin rejects:\n1. Delete pending bio from Blobs\n2. Send Basecamp message: \"{admin name} rejected {submitter name}'s bio. Discussion should happen here.\"\n\n### 6. Submission Flow\n1. User fills form (same UI)\n2. Backend writes bio JSON to Netlify Blobs\n3. Backend uploads original image to B2 `originals/` folder\n4. Basecamp notification sent\n5. Admin reviews at `/admin/bios`\n\n### 7. Export to YAML\nAdmin endpoint `/api/admin/export-bios?year=2026` generates YAML for archival.\n\n## Files to Create\n\n| File | Purpose |\n|------|---------|\n| `src/lib/server/blobs.ts` | Netlify Blobs utilities |\n| `src/lib/server/image-processing.ts` | Sharp utilities for image optimization |\n| `src/routes/api/people/[year].json/+server.ts` | SSR data endpoint merging YAML + Blobs |\n| `src/routes/api/bio-submission/submit/+server.ts` | New Blobs-based submission |\n| `src/routes/(app)/admin/bios/+page.svelte` | Admin UI |\n| `src/routes/(app)/admin/bios/+page.server.ts` | Admin data loading + auth |\n| `src/routes/api/admin/approve-bio/+server.ts` | Approve endpoint |\n| `src/routes/api/admin/reject-bio/+server.ts` | Reject endpoint |\n| `src/routes/api/admin/finish-approvals/+server.ts` | Cache purge + warming |\n| `src/routes/api/admin/export-bios/+server.ts` | YAML export |\n\n## Files to Modify\n\n| File | Changes |\n|------|---------|\n| `src/routes/(app)/who/[year]/+page.ts` | Use SSR endpoint for current season |\n| `src/routes/(app)/program-bios/+page.ts` | Use SSR endpoint |\n| `src/routes/(app)/bio-submission/+page.svelte` | Call new submission endpoint |\n| `src/routes/api/bio-submission/passphraseHelpers.ts` | Add `isAdmin(position)` helper |\n| `vite.config.ts` | Add `@netlify/vite-plugin` for local Blobs dev |\n| `package.json` | Add `@netlify/blobs`, `@netlify/functions` |\n\n## Data Schema (Blobs)\n\n```typescript\ninterface PendingBio {\n  position: number\n  firstName: string\n  lastName: string\n  location: string\n  email: string\n  bio: string\n  programBio?: string\n  staffPositions?: string[]\n  productionPositions?: Record\u003cstring, string[]\u003e\n  roles?: Record\u003cstring, string[]\u003e\n  originalImageUrl: string   // B2 originals/ URL\n  optimizedImageUrl?: string // B2 optimized/ URL (set on approval)\n  imageYear: number\n  submittedAt: string\n  approvedAt?: string\n  approvedBy?: string  // Admin name from passphrase position\n}\n```\n\n## Environment Variables\n\n**New:**\n- `ADMIN_PASSPHRASE_POSITIONS` - Comma-separated admin positions (e.g., \"1,2,3,4\")\n\n**Existing (keep):**\n- `B2_APPLICATION_KEY_ID`, `B2_APPLICATION_KEY`, `B2_BUCKET_ID`\n- `INDIVIDUAL_PASSPHRASES_LIST`\n- `BASECAMP_BIO_BOT_INTEGRATION_KEY`\n\n**Can remove later:**\n- `GITHUB_ACCESS_TOKEN`","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-22T00:05:41.344859-05:00","updated_at":"2025-12-22T00:13:56.218535-05:00"}
